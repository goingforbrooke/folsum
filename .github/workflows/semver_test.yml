name: 🍏 🏁 macOS and Windows Build, Bundle, and Publish
on:
  push:
    branches:
      - 'cicd/**'
jobs:
  build_macos:
    runs-on: macos-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          # Fetch all history for all tags and branches instead of `1`, which fetches only the current branch.
          fetch-depth: 0
      - name: Get current SemVer version from Cargo.toml
        id: get_current_semver
        run: echo "semver=v$(cargo metadata --format-version 1 | jq -r '.packages | .[] | select(.name=="${{ steps.get_repo_name.outputs.repo_name }}") | .version')" >> "$GITHUB_OUTPUT"
      - name: show semver
        run: echo "${{ steps.get_current_semver.outputs.semver }}"
